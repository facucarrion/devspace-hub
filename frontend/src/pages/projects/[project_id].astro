---
import Layout from '@layout/RootLayout.astro'
import { getProject } from '@lib/projects/getProject'

const { project_id } = Astro.params

if (!project_id) {
  Astro.redirect('/')
}

const project = await getProject(project_id as string)

console.log(project)
---

<Layout title={project.title}>
  <main class='flex flex-col w-full flex-grow gap-4'>
    <header class='flex items-center justify-between w-full gap-4 py-4'>
      <div class='flex items-center gap-4'>
        <img
          src={project.logo}
          alt={project.title}
          class='aspect-square h-24 rounded-full'
        />
        <div class="flex flex-col gap-2">
          <h1 class='text-2xl font-bold'>{project.title}</h1>
          <a class="underline" href={project.url}>{project.url}</a>  
          <span class="flex items-center gap-2">
            <img class="w-8 rounded-full" src={project.creator_avatar} alt={project.creator_username} />
            <a class="underline" href={`http://localhost:3000/users/${project.creator_username}`}>{project.creator_username}</a>
          </span>
        </div>
      </div>
      <p class="text-2xl">{project.upvotes}</p>
    </header>

    <p class='flex items-center text-[1.2rem]'>{project.description}</p>
    <img
      src={project.image ??
        'http://localhost:8080/img/placeholders/project.jpg'}
      alt={project.title}
      class='border-2 border-gray-200 rounded-md'
    />
    
    <section class="flex flex-wrap">
      {project.collaborators.map((item: any) => (
        <picture class="aspect-square h-12 w-12 rounded-full overflow-hidden">
          <img class="h-full" src={item.avatar} alt={item.username} title={item.username} />
  
        </picture>
      ))}
    </section>
  </main>
</Layout>
